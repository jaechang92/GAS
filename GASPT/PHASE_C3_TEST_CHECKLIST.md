# Phase C-3 테스트 체크리스트

**작성 날짜**: 2025-11-17
**목적**: Phase C-3 던전 진행 시스템 검증

---

## 📋 테스트 환경 확인

### 사전 준비
- [ ] GameplayScene 열림
- [ ] PortalUI.prefab 생성됨 (`Resources/Prefabs/UI/`)
- [ ] DungeonCompleteUI.prefab 생성됨 (`Resources/Prefabs/UI/`)
- [ ] RoomManager → DungeonCompleteUI 연결됨
- [ ] Portal들 → PortalUI 연결됨
- [ ] Play 모드 진입 가능

---

## 🎯 기능 테스트

### 1. 포탈 UI 표시/숨김 테스트

#### 테스트 시나리오:
```
1. Play 버튼 클릭
2. 첫 번째 방 진입
3. 적 모두 처치
4. 포탈 근처로 이동
```

#### 체크리스트:
- [ ] **포탈 활성화 확인**
  - 방 클리어 시 포탈 색상 변경 (회색 → 시안색)
  - 파티클 이펙트 재생 (있는 경우)
  - Console: `[Portal] 방 클리어 - 포탈 활성화!`

- [ ] **PortalUI 표시**
  - 포탈 범위 진입 시 UI 나타남
  - UI 위치: 화면 하단 중앙
  - 메시지: "E 키를 눌러 다음 방으로 이동"
  - Console: `[Portal] 플레이어가 포탈 범위 진입!`

- [ ] **PortalUI 숨김**
  - 포탈 범위 벗어남 시 UI 사라짐
  - Console: `[Portal] 플레이어가 포탈 범위 벗어남!`

- [ ] **E키 입력 반응**
  - 포탈 범위 안에서 E키 입력
  - PortalUI 즉시 사라짐
  - Console: `[Portal] 플레이어가 포탈 사용!`

---

### 2. 방 전환 테스트

#### 테스트 시나리오:
```
1. 포탈 범위 진입
2. E키 입력
3. 다음 방 로딩 확인
```

#### 체크리스트:
- [ ] **방 전환 성공**
  - 페이드 아웃/인 연출 (0.3초)
  - 다음 방으로 이동
  - 새 적들 스폰
  - Console: `[Portal] 포탈 사용 완료!`
  - Console: `[RoomManager] {방 이름}으로 이동 ({현재}/{총 방 수})`

- [ ] **플레이어 상태 유지**
  - 플레이어 HP 유지
  - 플레이어 위치 초기화
  - 골드/경험치 유지

---

### 3. 방 클리어 보상 테스트

#### 테스트 시나리오:
```
1. 임의의 방에서 적 모두 처치
2. Console 로그 확인
3. 플레이어 스탯 확인
```

#### 체크리스트:
- [ ] **골드 보상**
  - Console: `[Room] 보너스 골드 {금액} 획득!`
  - UI에 골드 증가 표시 (있는 경우)

- [ ] **경험치 보상**
  - Console: `[Room] 보너스 경험치 {수치} 획득!`
  - 레벨업 발생 시 애니메이션

- [ ] **체력 회복 (30%)**
  - Console: `[Room] 체력 회복! +{회복량} HP (현재: {현재HP}/{최대HP})`
  - HP 바 증가 확인
  - **체력이 가득 찬 경우**: `[Room] 이미 체력이 가득 차 있습니다.`

---

### 4. 던전 완주 테스트 (일반 방)

#### 테스트 시나리오:
```
1. 모든 방 클리어 (마지막 방이 보스방 아닌 경우)
2. 마지막 방 클리어
3. DungeonCompleteUI 확인
```

#### 체크리스트:
- [ ] **던전 완주 감지**
  - Console: `[RoomManager] 더 이상 방이 없습니다! (던전 클리어)`
  - Console: `[RoomManager] 던전 클리어!`

- [ ] **일반 보상 지급**
  - Console: `[RoomManager] 던전 완주 보너스 골드 200 획득!`
  - Console: `[RoomManager] 던전 완주 보너스 경험치 500 획득!`

- [ ] **플레이어 완전 회복**
  - Console: `[RoomManager] 플레이어 완전 회복! ({최대HP}/{최대HP})`
  - HP 바 100%

- [ ] **DungeonCompleteUI 표시**
  - UI 전체 화면 표시
  - 타이틀: "던전 클리어!"
  - 보상 정보: "총 획득 골드: {누적 골드}\n총 획득 경험치: {누적 경험치}"
  - 버튼 2개: "다음 던전", "메인 메뉴"

- [ ] **시간 정지**
  - Time.timeScale = 0 확인
  - 적 움직임 정지
  - 플레이어 입력 불가 (UI 버튼만 가능)

---

### 5. 던전 완주 테스트 (보스방)

#### 테스트 시나리오:
```
1. 마지막 방이 "BossRoom"인 Scene 준비
2. 보스 처치
3. DungeonCompleteUI 확인
```

#### 체크리스트:
- [ ] **보스방 감지**
  - Console: `[RoomManager] 던전 클리어!`
  - 내부적으로 `isBossRoom = true`

- [ ] **특별 보상 지급 (x2)**
  - Console: `[RoomManager] 던전 완주 보너스 골드 500 획득!`
  - Console: `[RoomManager] 던전 완주 보너스 경험치 1000 획득!`

- [ ] **플레이어 완전 회복**
  - HP 100%

- [ ] **DungeonCompleteUI 표시**
  - 보상 정보에 높은 골드/경험치 표시

---

### 6. DungeonCompleteUI 버튼 테스트

#### 테스트 시나리오:
```
1. 던전 완주 후 UI 표시됨
2. 각 버튼 클릭
```

#### 체크리스트:
- [ ] **"다음 던전" 버튼**
  - 클릭 시 Console: `[DungeonCompleteUI] 다음 던전 버튼 클릭`
  - 시간 재개 (Time.timeScale = 1)
  - 현재 씬 재시작
  - 플레이어 초기 위치로 이동
  - 모든 적 리스폰

- [ ] **"메인 메뉴" 버튼**
  - 클릭 시 Console: `[DungeonCompleteUI] 메인 메뉴 버튼 클릭`
  - 시간 재개 (Time.timeScale = 1)
  - 현재 씬 재시작 (임시 구현)
  - Warning: `[DungeonCompleteUI] 메인 메뉴 씬이 없으므로 현재 씬 재시작`

---

## 🐛 버그 테스트

### Edge Case 테스트

#### 1. 포탈 범위 밖에서 E키 입력
- [ ] **예상 동작**: 아무 일도 일어나지 않음
- [ ] **실제 동작**:

#### 2. 포탈 비활성화 상태에서 진입
- [ ] **예상 동작**: PortalUI 표시 안 됨
- [ ] **실제 동작**:

#### 3. 체력 가득 찬 상태에서 방 클리어
- [ ] **예상 동작**: "이미 체력이 가득 차 있습니다" 로그
- [ ] **실제 동작**:

#### 4. PlayerStats 없는 Scene
- [ ] **예상 동작**: Warning 로그, 체력 회복 스킬
- [ ] **실제 동작**:

#### 5. RoomManager에 DungeonCompleteUI 미연결
- [ ] **예상 동작**: Warning 로그, UI 표시 안 됨
- [ ] **실제 동작**:

#### 6. Portal에 PortalUI 미연결
- [ ] **예상 동작**: PortalUI 표시 안 됨, E키 입력은 정상 작동
- [ ] **실제 동작**:

---

## 🎮 플레이 테스트 (전체 시나리오)

### 시나리오 1: 정상 플레이 (3방)

```
[StartRoom]
1. 게임 시작
2. 적 2마리 처치
3. 골드 20, 경험치 50 획득
4. 체력 30% 회복 (예: 70 → 100)
5. 포탈 활성화 (시안색)
6. 포탈 근처 이동 → PortalUI 표시
7. E키 입력 → Room_1 이동

[Room_1]
8. 적 3마리 처치
9. 골드 30, 경험치 75 획득
10. 체력 30% 회복
11. E키로 Room_2 이동

[Room_2 (마지막)]
12. 적 4마리 처치
13. 골드 40, 경험치 100 획득
14. 체력 100% 회복 (던전 완주)
15. DungeonCompleteUI 표시
    - 총 골드: 90 + 200 = 290
    - 총 경험치: 225 + 500 = 725
16. "다음 던전" 클릭 → 씬 재시작
```

#### 체크리스트:
- [ ] 모든 방 정상 진행
- [ ] 골드/경험치 누적 정상
- [ ] 체력 회복 정상
- [ ] UI 표시 정상
- [ ] 버튼 클릭 정상

---

### 시나리오 2: 보스방 플레이

```
[StartRoom → BossRoom]
1. StartRoom 클리어
2. E키로 BossRoom 이동
3. 보스 처치 (HP 500)
4. 던전 완주 보상 (골드 500, 경험치 1000)
5. DungeonCompleteUI 표시
6. "메인 메뉴" 클릭 → 씬 재시작
```

#### 체크리스트:
- [ ] 보스방 보상 x2 정상
- [ ] 플레이어 완전 회복 정상
- [ ] UI 표시 정상
- [ ] 메인 메뉴 버튼 정상

---

## 🔍 콘솔 로그 확인

### 필수 로그 출력 확인

#### 방 클리어 시:
```
[Room] {방 이름} 클리어!
[Room] 보너스 골드 {금액} 획득!
[Room] 보너스 경험치 {수치} 획득!
[Room] 체력 회복! +{회복량} HP (현재: {현재HP}/{최대HP})
[Portal] 방 클리어 - 포탈 활성화!
```

#### 포탈 사용 시:
```
[Portal] 플레이어가 포탈 범위 진입!
[Portal] 플레이어가 포탈 사용!
[Portal] 포탈 사용 완료!
[RoomManager] {방 이름}으로 이동 ({현재}/{총 방 수})
```

#### 던전 완주 시:
```
[RoomManager] 더 이상 방이 없습니다! (던전 클리어)
[RoomManager] 던전 클리어!
[RoomManager] 던전 완주 보너스 골드 {금액} 획득!
[RoomManager] 던전 완주 보너스 경험치 {수치} 획득!
[RoomManager] 플레이어 완전 회복! ({최대HP}/{최대HP})
[DungeonCompleteUI] UI 표시 - 골드: {누적 골드}, 경험치: {누적 경험치}
```

#### UI 버튼 클릭 시:
```
[DungeonCompleteUI] 다음 던전 버튼 클릭
또는
[DungeonCompleteUI] 메인 메뉴 버튼 클릭
```

---

## ✅ 최종 확인 사항

### 코드 품질
- [ ] 컴파일 오류 없음
- [ ] 경고 메시지 없음 (중요한 것만)
- [ ] NullReferenceException 없음

### 성능
- [ ] 프레임 드롭 없음
- [ ] UI 렉 없음
- [ ] 메모리 누수 없음

### 사용자 경험
- [ ] 직관적인 포탈 사용 (E키)
- [ ] 명확한 보상 피드백
- [ ] 부드러운 방 전환
- [ ] 명확한 클리어 축하

---

## 📊 테스트 결과 기록

### 발견된 버그:
```
1.
2.
3.
```

### 개선 사항:
```
1.
2.
3.
```

### 추가 테스트 필요:
```
1.
2.
3.
```

---

## 🎯 테스트 완료 조건

Phase C-3가 완료되려면 다음 조건을 모두 만족해야 합니다:

- [ ] **모든 기능 테스트 통과** (1~6)
- [ ] **모든 Edge Case 정상 처리**
- [ ] **전체 플레이 시나리오 정상 작동**
- [ ] **콘솔 로그 정상 출력**
- [ ] **발견된 버그 0개** (또는 수정 완료)
- [ ] **성능 문제 없음**

---

**작성자**: Claude Code
**최종 수정**: 2025-11-17
**테스트 수행자**: _________________
**테스트 일시**: _________________
