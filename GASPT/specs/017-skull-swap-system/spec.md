# 스컬 교체 시스템

**기능 번호**: 017
**브랜치**: `017-skull-swap-system`
**작성일**: 2025-11-29
**상태**: 명세 완료

---

## 1. 개요

### 1.1 기능 설명
Skul: The Hero Slayer의 핵심 메카닉인 스컬(해골) 교체 시스템입니다. 플레이어는 최대 2개의 스컬을 보유하고 Q키로 즉시 교체할 수 있습니다. 각 스컬은 고유한 외형, 스탯, 스킬을 가지며, 전투 상황에 따라 전략적으로 교체하여 플레이합니다.

### 1.2 사용자 가치
- **전략적 깊이**: 상황에 맞는 스컬 선택으로 전투 전략 수립
- **수집 욕구**: 다양한 스컬 획득 및 조합 탐색
- **플레이 스타일 다양화**: 스컬마다 다른 플레이 경험
- **성장 만족감**: 스컬 각성을 통한 강화 체감

### 1.3 범위
- **포함**: 스컬 데이터, 스컬 교체, 스컬 획득, 스컬 각성, UI
- **제외**: 스컬 합성/조합, 스컬 커스터마이징

---

## 2. 사용자 시나리오

### 2.1 주요 시나리오: 스컬 교체

**전제조건**: 플레이어가 2개의 스컬을 보유

**흐름**:
1. 플레이어가 전투 중 Q키 입력
2. 현재 스컬이 비활성화되고 다른 스컬이 활성화
3. 플레이어 외형이 새 스컬로 즉시 변경
4. 스탯이 새 스컬 기준으로 변경
5. 스킬 슬롯이 새 스컬의 스킬로 교체
6. 화면에 스컬 교체 이펙트 표시
7. 교체 쿨다운 시작 (기본 5초)

### 2.2 시나리오: 새 스컬 획득

**전제조건**: 플레이어가 던전에서 스컬 아이템 발견

**흐름**:
1. 드롭된 스컬 아이템과 상호작용
2. 스컬 정보 팝업 표시 (이름, 등급, 스탯, 스킬 설명)
3. **보유 슬롯이 비어있는 경우**: 즉시 획득
4. **보유 슬롯이 가득 찬 경우**: 교체할 스컬 선택 UI 표시
5. 플레이어가 버릴 스컬 선택 또는 획득 취소
6. 선택한 스컬은 바닥에 드롭

### 2.3 시나리오: 스컬 각성

**전제조건**: 동일한 스컬을 2개 이상 획득

**흐름**:
1. 같은 종류의 스컬 획득 시 자동 각성 진행
2. 스컬 등급 상승 (일반 → 레어 → 유니크 → 레전더리)
3. 스탯 증가 및 스킬 강화
4. 각성 이펙트 및 축하 메시지 표시
5. 미니맵/HUD에 각성 완료 표시

### 2.4 시나리오: 스컬 정보 확인

**전제조건**: 플레이어가 인벤토리 열기 (I키)

**흐름**:
1. 보유 중인 스컬 2개 표시
2. 스컬 선택 시 상세 정보 표시
   - 이름, 등급, 현재 각성 단계
   - 기본 스탯 (공격력, 공격속도, 이동속도 등)
   - 스킬 1, 스킬 2 설명 및 쿨다운
   - 각성 효과 미리보기

---

## 3. 기능 요구사항

### 3.1 스컬 데이터

| ID | 요구사항 | 수락 기준 |
|----|----------|-----------|
| FR-001 | 스컬 기본 정보 | 이름, 설명, 등급, 타입 정의 |
| FR-002 | 스컬 스탯 | 공격력, 공격속도, 이동속도, 점프력 등 |
| FR-003 | 스컬 스킬 | 스킬 2개 (마우스 좌클릭, 우클릭) |
| FR-004 | 스컬 외형 | 스프라이트, 애니메이션 컨트롤러 |
| FR-005 | 스컬 등급 | 일반(Common), 레어(Rare), 유니크(Unique), 레전더리(Legendary) |

### 3.2 스컬 교체

| ID | 요구사항 | 수락 기준 |
|----|----------|-----------|
| FR-010 | Q키 교체 | Q키 입력 시 즉시 스컬 교체 |
| FR-011 | 교체 쿨다운 | 기본 5초, 스컬/아이템에 따라 감소 가능 |
| FR-012 | 교체 이펙트 | 시각적/청각적 피드백 |
| FR-013 | 즉시 적용 | 스탯, 스킬, 외형 즉시 변경 |
| FR-014 | 전투 중 교체 | 공격/피격 중에도 교체 가능 |
| FR-015 | 무적 프레임 | 교체 순간 짧은 무적 시간 (0.2초) |

### 3.3 스컬 슬롯

| ID | 요구사항 | 수락 기준 |
|----|----------|-----------|
| FR-020 | 최대 2슬롯 | 동시에 2개의 스컬만 보유 |
| FR-021 | 기본 스컬 | 게임 시작 시 기본 스컬 1개 지급 |
| FR-022 | 슬롯 표시 | HUD에 현재/대기 스컬 아이콘 표시 |
| FR-023 | 쿨다운 표시 | 대기 스컬 위에 쿨다운 오버레이 |

### 3.4 스컬 획득

| ID | 요구사항 | 수락 기준 |
|----|----------|-----------|
| FR-030 | 드롭 아이템 | 적/상자에서 스컬 드롭 |
| FR-031 | 상호작용 획득 | F키로 스컬 픽업 |
| FR-032 | 정보 미리보기 | 획득 전 스컬 정보 확인 가능 |
| FR-033 | 교체 선택 | 슬롯 가득 시 버릴 스컬 선택 |
| FR-034 | 드롭 스컬 | 버린 스컬은 바닥에 드롭 |

### 3.5 스컬 각성

| ID | 요구사항 | 수락 기준 |
|----|----------|-----------|
| FR-040 | 자동 각성 | 동일 스컬 획득 시 자동 각성 |
| FR-041 | 4단계 각성 | 일반 → 레어 → 유니크 → 레전더리 |
| FR-042 | 스탯 강화 | 각성 시 기본 스탯 20% 증가 |
| FR-043 | 스킬 강화 | 각성 시 스킬 효과/데미지 증가 |
| FR-044 | 각성 이펙트 | 시각적 축하 연출 |

### 3.6 스컬 타입 (초기 구현)

| ID | 스컬 타입 | 특징 |
|----|----------|------|
| FR-050 | Basic Skull | 기본 스컬, 밸런스형 |
| FR-051 | Warrior Skull | 근접 공격, 높은 체력 |
| FR-052 | Mage Skull | 원거리 마법, 낮은 체력 |
| FR-053 | Assassin Skull | 빠른 공격, 회피 특화 |
| FR-054 | Tank Skull | 높은 방어력, 느린 이동 |

---

## 4. 비기능 요구사항

| ID | 요구사항 | 기준 |
|----|----------|------|
| NFR-001 | 교체 반응성 | Q키 입력 후 0.1초 이내 교체 완료 |
| NFR-002 | 외형 전환 | 스프라이트/애니메이션 끊김 없이 전환 |
| NFR-003 | 확장성 | 새 스컬 추가 시 코드 수정 최소화 (ScriptableObject) |

---

## 5. 성공 기준

| 기준 | 측정 방법 |
|------|-----------|
| 교체 반응성 | Q키 입력 후 0.1초 이내 교체 완료 |
| 전략적 활용 | 플레이어가 보스전에서 평균 3회 이상 스컬 교체 |
| 스컬 다양성 | 5종 이상의 스컬이 플레이 가능 |
| 각성 만족도 | 각성 시 80% 이상 플레이어가 "강해진 느낌" 평가 |
| 수집 욕구 | 플레이어가 새 스컬 획득에 흥미를 느낌 |

---

## 6. 핵심 엔티티

### 6.1 SkullData (ScriptableObject)
- skullId: 고유 ID
- skullName: 스컬 이름
- description: 설명
- skullType: 타입 (Basic, Warrior, Mage, Assassin, Tank)
- baseRarity: 기본 등급
- baseStats: 기본 스탯 (공격력, 공격속도, 이동속도, 점프력, 체력보너스)
- skill1: 첫 번째 스킬 (SkillData 참조)
- skill2: 두 번째 스킬 (SkillData 참조)
- sprite: 아이콘 스프라이트
- animatorController: 애니메이션 컨트롤러
- swapEffect: 교체 시 이펙트 프리팹

### 6.2 SkullInstance (런타임 데이터)
- skullData: SkullData 참조
- currentRarity: 현재 등급 (각성 상태)
- awakeningLevel: 각성 단계 (0~3)
- currentStats: 현재 스탯 (각성 보너스 적용)

### 6.3 SkullManager
- currentSkull: 현재 활성 스컬
- reserveSkull: 대기 스컬
- swapCooldown: 교체 쿨다운 상태
- canSwap: 교체 가능 여부

---

## 7. 가정 사항

1. 기존 PlayerStats 시스템을 활용하여 스탯 적용
2. 기존 SkillSystem을 활용하여 스킬 교체
3. 기존 Form 시스템의 MageForm 구조를 참고하여 확장
4. 애니메이션 컨트롤러는 스컬별로 별도 제작

---

## 8. 의존성

- **PlayerStats**: 스탯 적용
- **SkillSystem**: 스킬 교체 및 실행
- **InventorySystem**: 스컬 보유 관리
- **LootSystem**: 스컬 드롭
- **UI System**: 스컬 슬롯 UI, 정보 팝업

---

## 9. 관련 문서

- 기존 Form 시스템: `Assets/_Project/Scripts/Player/Forms/`
- SkillSystem: `Assets/_Project/Scripts/Skills/`
- PlayerStats: `Assets/_Project/Scripts/Stats/`
