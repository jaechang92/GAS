# Phase C 기획 문서 (Game Content Expansion)

**작성 날짜**: 2025-11-13
**작성자**: Claude Code
**목표**: 게임 콘텐츠 확장 및 완성도 향상

---

## 📋 개요

Phase B에서 **플레이 가능한 프로토타입**이 완성되었습니다. Phase C에서는 게임 콘텐츠를 확장하고 완성도를 높여 **실제 게임다운 게임**을 만드는 것을 목표로 합니다.

### Phase C의 핵심 목표
1. **다양한 적 타입 추가** - 전투의 다양성 확보
2. **보스 전투 시스템** - 각 던전의 클라이맥스 제공
3. **던전 진행 완성** - 포탈 및 방 클리어 보상
4. **아이템 시스템 활용** - 장비 드롭 및 장착

---

## 🎯 Phase C 서브 Phase 구성

| Phase | 설명 | 우선순위 | 예상 작업량 |
|-------|------|----------|-------------|
| **C-1** | 다양한 적 타입 추가 | 높음 | ~800줄 |
| **C-2** | 보스 전투 시스템 | 높음 | ~600줄 |
| **C-3** | 던전 진행 완성 | 중간 | ~400줄 |
| **C-4** | 아이템 드롭 및 장착 | 중간 | ~500줄 |
| **총합** | **Phase C 전체** | - | **~2,300줄** |

---

## ✅ Phase C-1: 다양한 적 타입 추가

**목표**: 전투의 다양성과 전략성을 높이기 위해 여러 종류의 적을 추가합니다.

### 신규 적 타입

#### 1. RangedEnemy (원거리 적)
**특징**:
- 일정 거리에서 투사체 발사
- 플레이어가 접근하면 후퇴
- 낮은 HP, 높은 공격력

**AI 패턴**:
- 플레이어 감지 범위: 15 units
- 공격 범위: 10 units
- 최소 거리: 5 units (이하면 후퇴)
- 공격 쿨다운: 2초

**구현 파일**:
- `RangedEnemy.cs` (~200줄)
- `EnemyProjectile.cs` (~100줄)
- `RangedEnemy.prefab`

#### 2. FlyingEnemy (비행 적)
**특징**:
- 공중에서 이동 (Rigidbody2D.gravityScale = 0)
- 플레이어 머리 위에서 급강하 공격
- 지형 무시

**AI 패턴**:
- Y축 높이: 5~8 units
- 급강하 공격: 플레이어 위에서 돌진
- 공격 후 다시 상승
- 공격 쿨다운: 3초

**구현 파일**:
- `FlyingEnemy.cs` (~250줄)
- `FlyingEnemy.prefab`

#### 3. EliteEnemy (정예 적)
**특징**:
- 기본 근접 적의 강화 버전
- 높은 HP 및 공격력
- 특수 스킬 사용 (돌진, 스턴)

**AI 패턴**:
- 기본 패턴: BasicMeleeEnemy와 동일
- 특수 패턴 1: 플레이어에게 돌진 (쿨다운 5초)
- 특수 패턴 2: 범위 공격 (반경 3 units)

**구현 파일**:
- `EliteEnemy.cs` (~250줄)
- `EliteEnemy.prefab`

### 작업 내용

**신규 파일** (3개):
1. `RangedEnemy.cs` (200줄)
2. `FlyingEnemy.cs` (250줄)
3. `EliteEnemy.cs` (250줄)
4. `EnemyProjectile.cs` (100줄)

**수정 파일** (2개):
1. `PrefabCreator.cs` (+100줄) - 새 적 프리팹 생성 추가
2. `GameplaySceneCreator.cs` (+50줄) - 적 타입 랜덤 스폰

**생성 에셋**:
- `RangedGoblin.asset` (EnemyData)
- `FlyingBat.asset` (EnemyData)
- `EliteOrc.asset` (EnemyData)
- 3개 적 프리팹

### 테스트 요구사항
- [ ] RangedEnemy 원거리 공격 정상 작동
- [ ] RangedEnemy 후퇴 AI 정상 작동
- [ ] FlyingEnemy 급강하 공격 정상 작동
- [ ] FlyingEnemy 지형 무시 확인
- [ ] EliteEnemy 특수 스킬 정상 작동
- [ ] 모든 적 타입 풀링 정상 작동

---

## ✅ Phase C-2: 보스 전투 시스템

**목표**: 각 던전의 마지막 방에서 보스 전투를 제공하여 게임의 클라이맥스를 만듭니다.

### 보스 특징

#### BossEnemy
**특징**:
- 매우 높은 HP (500~1000)
- 다단계 전투 (Phase 1, 2, 3)
- 고유 패턴 공격
- 보스 전용 UI (BossHealthBar)

**전투 단계**:
- **Phase 1** (HP 100% ~ 70%):
  - 기본 근접 공격
  - 주기적인 원거리 공격 (3초마다)

- **Phase 2** (HP 70% ~ 30%):
  - 공격 속도 증가
  - 돌진 공격 추가 (5초마다)
  - 작은 적 소환 (10초마다, 최대 3마리)

- **Phase 3** (HP 30% ~ 0%):
  - 광폭화 (공격력 +50%, 이동 속도 +30%)
  - 범위 공격 (반경 5 units, 7초마다)
  - 회복 차단 (플레이어 회복 스킬 봉인)

**보스 패턴 예시**:
```
Phase 1:
[근접 공격] → [이동] → [원거리 공격] → [이동] → 반복

Phase 2:
[근접 공격] → [돌진] → [원거리 공격] → [소환] → 반복

Phase 3:
[광폭화] → [근접 공격 x3] → [범위 공격] → [돌진] → 반복
```

### 구현 파일

**신규 파일** (4개):
1. `BossEnemy.cs` (~400줄) - 보스 AI 및 패턴
2. `BossPhaseController.cs` (~150줄) - 단계별 전환 로직
3. `BossHealthBar.cs` (이미 존재, 수정 필요)
4. `BossSpawnPoint.cs` (~50줄)

**수정 파일** (2개):
1. `Room.cs` (+50줄) - 보스 방 전용 로직 추가
2. `GameplaySceneCreator.cs` (+50줄) - BossRoom에 보스 스폰 포인트 추가

**생성 에셋**:
- `FireDragon.asset` (BossEnemy 데이터)
- `BossEnemy.prefab`

### 테스트 요구사항
- [ ] 보스 HP에 따른 Phase 전환 정상 작동
- [ ] 각 Phase별 고유 패턴 정상 작동
- [ ] 보스 소환 시스템 정상 작동
- [ ] BossHealthBar UI 정상 표시
- [ ] 보스 처치 시 특별 보상

---

## ✅ Phase C-3: 던전 진행 완성

**목표**: 방 클리어 보상, 포탈 시스템, 던전 완주 보상을 구현하여 던전 진행의 완성도를 높입니다.

### 주요 기능

#### 1. 포탈 활성화 시스템
**현재 상태**: Portal.cs 존재하지만 미사용

**구현 내용**:
- 방 클리어 시 포탈 활성화
- 포탈 시각 효과 (빛나는 애니메이션)
- 플레이어가 포탈에 접근하면 "E키로 다음 방 이동" UI 표시
- E키 입력 시 다음 방으로 이동

#### 2. 방 클리어 보상
**보상 종류**:
- 골드 보너스 (방 난이도에 따라 차등)
- 체력 회복 (현재 HP의 30%)
- 랜덤 아이템 드롭 (확률 50%)

**구현 위치**:
- `Room.cs` - `OnRoomCleared()` 메서드

#### 3. 던전 완주 보상
**보스 방 클리어 시**:
- 대량의 골드
- 레벨업 보상
- 고급 장비 확정 드롭
- "던전 클리어!" UI 표시

### 구현 파일

**수정 파일** (3개):
1. `Portal.cs` (+100줄) - 포탈 활성화 및 상호작용
2. `Room.cs` (+150줄) - 방 클리어 보상 로직
3. `RoomManager.cs` (+100줄) - 던전 완주 감지 및 보상

**신규 파일** (2개):
1. `PortalUI.cs` (~50줄) - "E키로 이동" UI
2. `DungeonCompleteUI.cs` (~100줄) - 던전 클리어 축하 UI

### 테스트 요구사항
- [ ] 방 클리어 시 포탈 활성화
- [ ] 포탈 상호작용 정상 작동
- [ ] 방 클리어 보상 정상 지급
- [ ] 던전 완주 보상 정상 지급
- [ ] 던전 클리어 UI 정상 표시

---

## ✅ Phase C-4: 아이템 드롭 및 장착

**목표**: 기존에 구현된 아이템 시스템(Item, InventorySystem)을 활용하여 아이템 드롭 및 장착 기능을 구현합니다.

### 주요 기능

#### 1. 아이템 드롭 시스템
**드롭 시나리오**:
- 적 사망 시 확률적으로 아이템 드롭
- 방 클리어 시 보너스 아이템
- 보스 처치 시 고급 아이템 확정 드롭

**드롭 로직**:
```csharp
// Enemy.cs - Die() 메서드에 추가
if (Random.value <= dropChance)
{
    DropItem();
}

private void DropItem()
{
    // LootSystem 사용 (이미 구현됨)
    LootSystem.Instance.DropLoot(transform.position, enemyData.lootTable);
}
```

#### 2. 아이템 획득 UI
**ItemPickupUI 활성화**:
- 드롭된 아이템 근처에 플레이어 접근 시
- "F키로 획득" UI 표시
- F키 입력 시 인벤토리에 추가

#### 3. 인벤토리 UI
**간단한 인벤토리 창**:
- I키로 인벤토리 열기/닫기
- 획득한 아이템 목록 표시
- 아이템 클릭 시 장착/사용

#### 4. 장비 장착 시스템
**이미 구현된 시스템 활용**:
- `PlayerStats.EquipItem()` - 이미 존재
- `PlayerStats.UnequipItem()` - 이미 존재
- 장착 시 스탯 자동 업데이트

### 구현 파일

**수정 파일** (3개):
1. `Enemy.cs` (+50줄) - 아이템 드롭 로직 추가
2. `ItemPickupUI.cs` (+100줄) - 획득 UI 활성화
3. `LootSystem.cs` (이미 존재, 활성화만 필요)

**신규 파일** (2개):
1. `InventoryUI.cs` (~200줄) - 인벤토리 UI
2. `ItemSlotUI.cs` (~100줄) - 아이템 슬롯 UI

**생성 에셋**:
- 추가 장비 아이템 3개 (Sword, Shield, Helmet)

### 테스트 요구사항
- [ ] 적 처치 시 아이템 드롭 정상 작동
- [ ] 아이템 획득 UI 정상 표시
- [ ] F키로 아이템 획득 정상 작동
- [ ] 인벤토리 UI 정상 동작
- [ ] 아이템 장착 시 스탯 변경 확인

---

## 📊 Phase C 전체 요약

### 작업량 예상
| Phase | 신규 파일 | 수정 파일 | 코드량 | 우선순위 |
|-------|-----------|-----------|--------|----------|
| C-1 | 4개 | 2개 | ~800줄 | 높음 |
| C-2 | 4개 | 2개 | ~600줄 | 높음 |
| C-3 | 2개 | 3개 | ~400줄 | 중간 |
| C-4 | 2개 | 3개 | ~500줄 | 중간 |
| **총합** | **12개** | **10개** | **~2,300줄** | - |

### 기대 효과

**Phase C 완료 후 게임 상태**:
1. ✅ 다양한 적 타입으로 전투의 다양성 확보
2. ✅ 보스 전투로 게임의 클라이맥스 제공
3. ✅ 던전 진행 시스템 완성으로 완결성 향상
4. ✅ 아이템 드롭 및 장착으로 RPG 요소 강화

**플레이어 경험**:
- 던전 시작 → 다양한 적과 전투 → 방 클리어 보상 → 포탈로 이동 → 보스 전투 → 던전 완주 → 보상 획득

---

## 🚀 Phase C 진행 순서 (권장)

### 옵션 1: 순차 진행 (안정적)
```
Phase C-1 → Phase C-2 → Phase C-3 → Phase C-4
```
- 각 Phase 완료 후 테스트 및 커밋
- 안정적이지만 시간 소요

### 옵션 2: 병렬 진행 (빠름)
```
Phase C-1 + C-3 (동시 진행)
→ Phase C-2 + C-4 (동시 진행)
```
- 적 타입과 던전 진행을 먼저 완성
- 보스와 아이템을 나중에 추가

### 옵션 3: MVP 우선 (최소 기능)
```
Phase C-1 (RangedEnemy만)
→ Phase C-2 (보스 기본 패턴만)
→ Phase C-3 (포탈만)
→ Phase C-4 (아이템 드롭만)
```
- 각 Phase의 핵심 기능만 먼저 구현
- 빠른 프로토타입 완성 후 점진적 확장

---

## 🎯 Phase C 완료 기준

### 필수 요구사항
- [ ] 최소 3종류의 적 타입 구현 (Melee, Ranged, Flying 또는 Elite)
- [ ] 보스 전투 시스템 구현 (최소 2단계 Phase)
- [ ] 포탈 시스템 정상 작동
- [ ] 방 클리어 보상 지급
- [ ] 아이템 드롭 및 획득 정상 작동

### 선택 요구사항
- [ ] 던전 클리어 축하 UI
- [ ] 인벤토리 UI
- [ ] 보스 소환 시스템
- [ ] 특수 보상 (고급 장비)

---

## 📝 다음 단계

Phase C 완료 후:
1. **Phase D: 추가 Form 구현** (WarriorForm, RogueForm)
2. **Phase E: 스킬 시스템 확장** (더 많은 스킬 및 콤보)
3. **Phase F: 게임 밸런싱 및 최적화**
4. **Phase G: 최종 폴리싱** (사운드, 파티클, UI 개선)

---

## 🤔 고려사항

### 기술적 고려사항
1. **적 AI 성능**: 많은 적이 동시에 AI를 실행하면 성능 저하 가능
   - 해결: AI 업데이트 주기 조절 (0.1초마다)
2. **보스 패턴 복잡도**: 너무 복잡하면 버그 발생 가능성 증가
   - 해결: 단순하게 시작, 점진적 확장
3. **아이템 드롭 밸런싱**: 너무 많거나 적으면 게임 밸런스 붕괴
   - 해결: 드롭 확률 조정 가능하도록 설계

### 디자인 고려사항
1. **난이도 곡선**: 방이 진행될수록 점점 어려워져야 함
2. **보상 밸런싱**: 플레이어가 성취감을 느낄 수 있도록
3. **플레이 시간**: 한 던전 완주에 5~10분 목표

---

**작성자**: Claude Code
**최종 수정**: 2025-11-13
